<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Dashboard Pelanggan WiFi</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #f4f6f8;
  margin: 0;
}

header {
  background: #0d6efd;
  color: white;
  padding: 20px;
  text-align: center;
}

.container {
  max-width: 900px;
  margin: 20px auto;
  padding: 10px;
}

.card {
  background: white;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.card h3 {
  margin-top: 0;
}

.badge {
  padding: 5px 10px;
  border-radius: 5px;
  color: white;
  font-size: 12px;
}

.badge.belum {
  background: #dc3545;
}

.badge.lunas {
  background: #28a745;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 15px;
}

th, td {
  padding: 12px;
  border-bottom: 1px solid #ddd;
  text-align: center;
}

th {
  background: #f0f0f0;
}

footer {
  text-align: center;
  padding: 15px;
  color: #666;
  font-size: 13px;
}
</style>
</head>

<body>

<header>
  <h2>Dashboard Pelanggan WiFi</h2>
  <p id="info"></p>
</header>

<div class="container">
  <div class="card">
    <h3>Tagihan Anda</h3>
    <div id="tagihan">Memuat data...</div>
  </div>
</div>

<footer>
  Â© 2025 Sistem WiFi
</footer>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbx-2UO59jdn0PEshpGQ2eCMKj1rGBRiFicgZ-Sf0jr_oRcwrEIwO0vaS3IPqnO_-XDkrA/exec";

const params = new URLSearchParams(window.location.search);
const email = params.get("email");

document.getElementById("info").innerText = "Login sebagai: " + email;

// JSONP call
var s = document.createElement("script");
s.src = API_URL
  + "?action=getTagihan"
  + "&email=" + encodeURIComponent(email)
  + "&callback=showTagihan";

document.body.appendChild(s);

function formatRupiah(n){
  return "Rp " + n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
}

function formatBulan(tgl){
  return new Date(tgl).toLocaleDateString("id-ID", {
    month: "long",
    year: "numeric"
  });
}

function showTagihan(data){
  if(data.length === 0){
    document.getElementById("tagihan").innerHTML =
      "<p>Tidak ada tagihan.</p>";
    return;
  }

  var html = "<table>";
  html += "<tr><th>Bulan</th><th>Paket</th><th>Jumlah</th><th>Status</th></tr>";

  data.forEach(t => {
    var badge =
      t.status === "Lunas"
      ? "<span class='badge lunas'>Lunas</span>"
      : "<span class='badge belum'>Belum Bayar</span>";

    html += `
      <tr>
        <td>${formatBulan(t.bulan)}</td>
        <td>${t.paket}</td>
        <td>${formatRupiah(t.jumlah)}</td>
        <td>${badge}</td>
      </tr>
    `;
  });

  html += "</table>";
  document.getElementById("tagihan").innerHTML = html;
}
</script>

</body>
</html>
 